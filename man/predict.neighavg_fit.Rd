% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/neighavg_fit.R
\name{predict.neighavg_fit}
\alias{predict.neighavg_fit}
\title{Predict with Neighborhood Averaging Fit}
\usage{
\method{predict}{neighavg_fit}(object, newdata, ...)
}
\arguments{
\item{object}{A fitted neighborhood averaging model of class
\code{neighavg_fit}, containing training data, coordinates, and metadata.}

\item{newdata}{A matrix or data frame of new observations with features as
columns and cell IDs as row names. Row names must be unique and non-NA.}

\item{...}{Additional arguments (currently unused).}
}
\value{
A numeric matrix with the same number of rows as \code{newdata} and
the same set of intersected features. Row names are preserved from
\code{newdata}.
}
\description{
Applies neighborhood averaging to new expression data based on a fitted
neighborhood averaging model (\code{neighavg_fit}). Each new sample is
corrected by averaging feature values across training neighbors within a
defined spatial window.
}
\details{
The function requires both \code{coords_all} (all coordinates) and
\code{coords_train} (training coordinates). It identifies neighbors within
a rectangular window of size \code{n.size} around each new sample based on
spatial coordinates (\code{x_name}, \code{y_name}). If multiple neighbors
are found, their features are averaged; otherwise, the original feature
values are retained.

Several validity checks are performed:
\itemize{
\item Row names in \code{newdata} must be unique and non-missing.
\item Training and new data must share at least one common feature.
\item Required coordinate columns must exist in training and all-coordinates sets.
\item Coordinates must have row names matching sample IDs.
}
}
\examples{
\dontrun{
# Assuming `fit` is a neighavg_fit object created earlier:
preds <- predict(fit, newdata = new_expr_matrix)
}

}
\keyword{internal}
